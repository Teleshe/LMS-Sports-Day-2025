<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LMS Sports Day 2025 - Live Tracker</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 8px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple icon replacements
        const Trophy = () => <span className="icon">🏆</span>;
        const Clock = () => <span className="icon">⏰</span>;
        const Users = () => <span className="icon">👥</span>;
        const Edit3 = () => <span className="icon">✏️</span>;
        const Play = () => <span className="icon">▶️</span>;
        const Plus = () => <span className="icon">➕</span>;

        const LMSSportsDay = () => {
          const [teams, setTeams] = useState([]);
          const [events, setEvents] = useState([
            { id: 1, name: 'Eppendorf & Spoon Race', time: '2:45pm - 2:55pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 2, name: 'Wheelbarrow Race', time: '2:55pm - 3:05pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 3, name: 'Get Your PPE On (Obstacle Course)', time: '3:05pm - 3:20pm', type: 'team', status: 'upcoming', results: [] },
            { id: 4, name: 'Cold Pack Shot Put', time: '3:20pm - 3:30pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 5, name: 'Three-Legged Race', time: '3:30pm - 3:45pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 6, name: 'Tug of War', time: '3:45pm - 3:55pm', type: 'team', status: 'upcoming', results: [] },
            { id: 7, name: 'Frisbee Throw', time: '3:55pm - 4:05pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 8, name: '100m Sprint', time: '4:05pm - 4:20pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 9, name: 'Limbo', time: '4:20pm - 4:30pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 10, name: 'Tag Rugby', time: '4:30pm - 4:40pm', type: 'team', status: 'upcoming', results: [] },
            { id: 11, name: 'Musical Pipettes', time: '4:40pm - 4:50pm', type: 'individual', status: 'upcoming', results: [] },
            { id: 12, name: 'Pipette Relay Race', time: '4:50pm - 4:55pm', type: 'team', status: 'upcoming', results: [] },
            { id: 13, name: 'Scavenger Hunt', time: 'All Day', type: 'special', status: 'upcoming', results: [] },
            { id: 14, name: 'Hula Hoop Challenge', time: 'Side Activity', type: 'side', status: 'upcoming', results: [] },
            { id: 15, name: 'Football Keepy-Ups', time: 'Side Activity', type: 'side', status: 'upcoming', results: [] }
          ]);
          const [currentView, setCurrentView] = useState('dashboard');
          const [selectedEvent, setSelectedEvent] = useState(null);
          const [newTeam, setNewTeam] = useState({ name: '', members: [{ name: '', floor: '' }] });

          const floors = ['Floor 1', 'Floor 2', 'Floor 3', 'Floor 4', 'Floor 5', 'Floor 6', 'Floor 7', 'ICTEM', 'Mansfield'];

          const getPointsForPosition = (eventType, position) => {
            if (eventType === 'individual') {
              const points = [10, 8, 6, 4, 2, 1];
              return points[position - 1] || 1;
            } else if (eventType === 'team') {
              const points = [15, 12, 9, 6, 3, 1];
              return points[position - 1] || 1;
            } else if (eventType === 'special') {
              const points = [20, 15, 10, 5];
              return points[position - 1] || 5;
            }
            return 0;
          };

          const calculateTeamScores = () => {
            return teams.map(team => {
              let totalPoints = 0;
              events.forEach(event => {
                const result = event.results.find(r => r.teamId === team.id);
                if (result) {
                  totalPoints += getPointsForPosition(event.type, result.position);
                }
              });
              return { ...team, totalPoints };
            }).sort((a, b) => b.totalPoints - a.totalPoints);
          };

          const calculateFloorScores = () => {
            const floorScores = {};
            floors.forEach(floor => {
              floorScores[floor] = 0;
            });

            teams.forEach(team => {
              let teamTotalPoints = 0;
              events.forEach(event => {
                const result = event.results.find(r => r.teamId === team.id);
                if (result) {
                  teamTotalPoints += getPointsForPosition(event.type, result.position);
                }
              });
              
              team.members.forEach(member => {
                if (member.floor) {
                  floorScores[member.floor] += teamTotalPoints / team.members.length;
                }
              });
            });

            return Object.entries(floorScores)
              .map(([floor, points]) => ({ floor, points: Math.round(points * 10) / 10 }))
              .sort((a, b) => b.points - a.points);
          };

          const addTeam = () => {
            if (newTeam.name.trim()) {
              const team = {
                id: Date.now(),
                name: newTeam.name,
                members: newTeam.members.filter(m => m.name.trim())
              };
              setTeams([...teams, team]);
              setNewTeam({ name: '', members: [{ name: '', floor: '' }] });
            }
          };

          const updateEventResult = (eventId, results) => {
            setEvents(events.map(event => 
              event.id === eventId 
                ? { ...event, results, status: 'completed' }
                : event
            ));
          };

          const startEvent = (eventId) => {
            setEvents(events.map(event => 
              event.id === eventId 
                ? { ...event, status: 'in-progress' }
                : event
            ));
          };

          const getCurrentTime = () => {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            return hours * 60 + minutes;
          };

          const getEventStatus = (event) => {
            if (event.status === 'completed') return 'completed';
            if (event.status === 'in-progress') return 'in-progress';
            
            if (event.time === 'All Day' || event.time === 'Side Activity') {
              return 'ongoing';
            }
            
            const timeRange = event.time.split(' - ');
            if (timeRange.length === 2) {
              const startTime = parseTime(timeRange[0]);
              const endTime = parseTime(timeRange[1]);
              const currentTime = getCurrentTime();
              
              if (currentTime >= startTime && currentTime <= endTime) {
                return 'current';
              } else if (currentTime > endTime) {
                return 'past';
              }
            }
            
            return 'upcoming';
          };

          const parseTime = (timeStr) => {
            const [time, period] = timeStr.split(/(?=[ap]m)/);
            let [hours, minutes] = time.split(':').map(Number);
            if (period === 'pm' && hours !== 12) hours += 12;
            if (period === 'am' && hours === 12) hours = 0;
            return hours * 60 + minutes;
          };

          const teamScores = calculateTeamScores();
          const floorScores = calculateFloorScores();

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
              <div className="container mx-auto px-4 py-6">
                <div className="text-center mb-8">
                  <h1 className="text-4xl font-bold text-indigo-800 mb-2">🏃‍♀️ LMS Sports Day 2025 🏃‍♂️</h1>
                  <p className="text-lg text-indigo-600">Live Tracker • The Scrubs</p>
                </div>

                {/* Navigation */}
                <div className="flex flex-wrap justify-center gap-4 mb-8">
                  <button
                    onClick={() => setCurrentView('dashboard')}
                    className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                      currentView === 'dashboard' 
                        ? 'bg-indigo-600 text-white shadow-lg' 
                        : 'bg-white text-indigo-600 hover:bg-indigo-50'
                    }`}
                  >
                    <Trophy />
                    Dashboard
                  </button>
                  <button
                    onClick={() => setCurrentView('events')}
                    className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                      currentView === 'events' 
                        ? 'bg-indigo-600 text-white shadow-lg' 
                        : 'bg-white text-indigo-600 hover:bg-indigo-50'
                    }`}
                  >
                    <Clock />
                    Events
                  </button>
                  <button
                    onClick={() => setCurrentView('teams')}
                    className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                      currentView === 'teams' 
                        ? 'bg-indigo-600 text-white shadow-lg' 
                        : 'bg-white text-indigo-600 hover:bg-indigo-50'
                    }`}
                  >
                    <Users />
                    Teams
                  </button>
                  <button
                    onClick={() => setCurrentView('scoring')}
                    className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                      currentView === 'scoring' 
                        ? 'bg-indigo-600 text-white shadow-lg' 
                        : 'bg-white text-indigo-600 hover:bg-indigo-50'
                    }`}
                  >
                    <Edit3 />
                    Score Entry
                  </button>
                </div>

                {/* Dashboard View */}
                {currentView === 'dashboard' && (
                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    {/* Team Championship */}
                    <div className="bg-white rounded-xl shadow-lg p-6">
                      <h2 className="text-2xl font-bold text-indigo-800 mb-4">🏆 Team Championship</h2>
                      <div className="space-y-3">
                        {teamScores.slice(0, 10).map((team, index) => (
                          <div key={team.id} className="flex items-center justify-between p-3 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-lg">
                            <div className="flex items-center">
                              <span className={`text-lg font-bold w-8 h-8 rounded-full flex items-center justify-center ${
                                index === 0 ? 'bg-yellow-400 text-yellow-800' :
                                index === 1 ? 'bg-gray-300 text-gray-800' :
                                index === 2 ? 'bg-orange-400 text-orange-800' :
                                'bg-indigo-100 text-indigo-800'
                              }`}>
                                {index + 1}
                              </span>
                              <span className="ml-3 font-semibold text-gray-800">{team.name}</span>
                            </div>
                            <span className="text-xl font-bold text-indigo-600">{team.totalPoints} pts</span>
                          </div>
                        ))}
                        {teamScores.length === 0 && (
                          <p className="text-center text-gray-500 py-8">No teams registered yet</p>
                        )}
                      </div>
                    </div>

                    {/* Floor Championship */}
                    <div className="bg-white rounded-xl shadow-lg p-6">
                      <h2 className="text-2xl font-bold text-indigo-800 mb-4">🏢 Floor Championship</h2>
                      <div className="space-y-3">
                        {floorScores.slice(0, 10).map((floor, index) => (
                          <div key={floor.floor} className="flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg">
                            <div className="flex items-center">
                              <span className={`text-lg font-bold w-8 h-8 rounded-full flex items-center justify-center ${
                                index === 0 ? 'bg-yellow-400 text-yellow-800' :
                                index === 1 ? 'bg-gray-300 text-gray-800' :
                                index === 2 ? 'bg-orange-400 text-orange-800' :
                                'bg-green-100 text-green-800'
                              }`}>
                                {index + 1}
                              </span>
                              <span className="ml-3 font-semibold text-gray-800">{floor.floor}</span>
                            </div>
                            <span className="text-xl font-bold text-green-600">{floor.points} pts</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                )}

                {/* Events View */}
                {currentView === 'events' && (
                  <div className="bg-white rounded-xl shadow-lg p-6">
                    <h2 className="text-2xl font-bold text-indigo-800 mb-6">📅 Event Schedule</h2>
                    <div className="space-y-4">
                      {events.map(event => {
                        const status = getEventStatus(event);
                        return (
                          <div key={event.id} className={`p-4 rounded-lg border-l-4 ${
                            status === 'completed' ? 'bg-green-50 border-green-400' :
                            status === 'in-progress' ? 'bg-yellow-50 border-yellow-400' :
                            status === 'current' ? 'bg-blue-50 border-blue-400' :
                            status === 'ongoing' ? 'bg-purple-50 border-purple-400' :
                            'bg-gray-50 border-gray-300'
                          }`}>
                            <div className="flex items-center justify-between">
                              <div>
                                <h3 className="font-semibold text-gray-800">{event.name}</h3>
                                <p className="text-sm text-gray-600">
                                  {event.time} • {event.type === 'individual' ? 'Individual' : event.type === 'team' ? 'Team' : event.type === 'special' ? 'Scavenger Hunt' : 'Side Activity'}
                                </p>
                              </div>
                              <div className="flex items-center space-x-2">
                                <span className={`px-3 py-1 rounded-full text-sm font-semibold ${
                                  status === 'completed' ? 'bg-green-100 text-green-800' :
                                  status === 'in-progress' ? 'bg-yellow-100 text-yellow-800' :
                                  status === 'current' ? 'bg-blue-100 text-blue-800' :
                                  status === 'ongoing' ? 'bg-purple-100 text-purple-800' :
                                  'bg-gray-100 text-gray-800'
                                }`}>
                                  {status === 'completed' ? 'Completed' :
                                   status === 'in-progress' ? 'In Progress' :
                                   status === 'current' ? 'Current' :
                                   status === 'ongoing' ? 'Ongoing' :
                                   'Upcoming'}
                                </span>
                                {event.results.length > 0 && (
                                  <span className="text-sm text-gray-500">
                                    {event.results.length} results
                                  </span>
                                )}
                              </div>
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                )}

                {/* Teams View */}
                {currentView === 'teams' && (
                  <div className="space-y-6">
                    {/* Add Team */}
                    <div className="bg-white rounded-xl shadow-lg p-6">
                      <h2 className="text-2xl font-bold text-indigo-800 mb-4">➕ Add New Team</h2>
                      <div className="space-y-4">
                        <input
                          type="text"
                          placeholder="Team Name"
                          value={newTeam.name}
                          onChange={(e) => setNewTeam({...newTeam, name: e.target.value})}
                          className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                        />
                        <div className="space-y-2">
                          <h3 className="font-semibold text-gray-700">Team Members</h3>
                          {newTeam.members.map((member, index) => (
                            <div key={index} className="flex space-x-2">
                              <input
                                type="text"
                                placeholder="Member Name"
                                value={member.name}
                                onChange={(e) => {
                                  const updatedMembers = [...newTeam.members];
                                  updatedMembers[index].name = e.target.value;
                                  setNewTeam({...newTeam, members: updatedMembers});
                                }}
                                className="flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                              />
                              <select
                                value={member.floor}
                                onChange={(e) => {
                                  const updatedMembers = [...newTeam.members];
                                  updatedMembers[index].floor = e.target.value;
                                  setNewTeam({...newTeam, members: updatedMembers});
                                }}
                                className="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                              >
                                <option value="">Select Floor</option>
                                {floors.map(floor => (
                                  <option key={floor} value={floor}>{floor}</option>
                                ))}
                              </select>
                            </div>
                          ))}
                          <button
                            onClick={() => setNewTeam({...newTeam, members: [...newTeam.members, { name: '', floor: '' }]})}
                            className="text-indigo-600 hover:text-indigo-800 text-sm font-semibold"
                          >
                            + Add Member
                          </button>
                        </div>
                        <button
                          onClick={addTeam}
                          className="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
                        >
                          Add Team
                        </button>
                      </div>
                    </div>

                    {/* Team List */}
                    <div className="bg-white rounded-xl shadow-lg p-6">
                      <h2 className="text-2xl font-bold text-indigo-800 mb-4">👥 Registered Teams</h2>
                      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        {teams.map(team => (
                          <div key={team.id} className="p-4 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-lg">
                            <h3 className="font-bold text-indigo-800 mb-2">{team.name}</h3>
                            <div className="space-y-1">
                              {team.members.map((member, index) => (
                                <div key={index} className="text-sm text-gray-600">
                                  {member.name} {member.floor && `(${member.floor})`}
                                </div>
                              ))}
                            </div>
                          </div>
                        ))}
                        {teams.length === 0 && (
                          <p className="text-center text-gray-500 py-8 col-span-full">No teams registered yet</p>
                        )}
                      </div>
                    </div>
                  </div>
                )}

                {/* Scoring View */}
                {currentView === 'scoring' && (
                  <div className="bg-white rounded-xl shadow-lg p-6">
                    <h2 className="text-2xl font-bold text-indigo-800 mb-6">📊 Score Entry</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                      {events.map(event => (
                        <div key={event.id} className="p-4 border border-gray-200 rounded-lg">
                          <div className="flex items-center justify-between mb-3">
                            <h3 className="font-semibold text-gray-800">{event.name}</h3>
                            <div className="flex space-x-2">
                              {event.status === 'upcoming' && (
                                <button
                                  onClick={() => startEvent(event.id)}
                                  className="p-1 text-blue-600 hover:text-blue-800"
                                  title="Start Event"
                                >
                                  <Play />
                                </button>
                              )}
                              <button
                                onClick={() => setSelectedEvent(event)}
                                className="p-1 text-indigo-600 hover:text-indigo-800"
                                title="Enter Results"
                              >
                                <Edit3 />
                              </button>
                            </div>
                          </div>
                          <p className="text-sm text-gray-600 mb-2">{event.time}</p>
                          <div className="flex items-center space-x-2">
                            <span className={`px-2 py-1 rounded-full text-xs font-semibold ${
                              event.status === 'completed' ? 'bg-green-100 text-green-800' :
                              event.status === 'in-progress' ? 'bg-yellow-100 text-yellow-800' :
                              'bg-gray-100 text-gray-800'
                            }`}>
                              {event.status === 'completed' ? 'Completed' :
                               event.status === 'in-progress' ? 'In Progress' :
                               'Upcoming'}
                            </span>
                            {event.results.length > 0 && (
                              <span className="text-xs text-gray-500">
                                {event.results.length} results
                              </span>
                            )}
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {/* Score Entry Modal */}
                {selectedEvent && (
                  <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                    <div className="bg-white rounded-xl max-w-md w-full max-h-96 overflow-y-auto">
                      <div className="p-6">
                        <h3 className="text-xl font-bold text-indigo-800 mb-4">
                          Enter Results: {selectedEvent.name}
                        </h3>
                        <div className="space-y-4">
                          {teams.map((team, index) => (
                            <div key={team.id} className="flex items-center space-x-3">
                              <span className="font-semibold text-gray-800 flex-1">{team.name}</span>
                              <select
                                value={selectedEvent.results.find(r => r.teamId === team.id)?.position || ''}
                                onChange={(e) => {
                                  const position = parseInt(e.target.value);
                                  const existingResults = selectedEvent.results.filter(r => r.teamId !== team.id);
                                  const newResults = position ? [...existingResults, { teamId: team.id, position }] : existingResults;
                                  updateEventResult(selectedEvent.id, newResults);
                                }}
                                className="p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-indigo-500"
                              >
                                <option value="">Select Position</option>
                                {[1,2,3,4,5,6,7,8,9,10].map(pos => (
                                  <option key={pos} value={pos}>{pos}{pos === 1 ? 'st' : pos === 2 ? 'nd' : pos === 3 ? 'rd' : 'th'}</option>
                                ))}
                              </select>
                            </div>
                          ))}
                        </div>
                        <div className="mt-6 flex space-x-3">
                          <button
                            onClick={() => setSelectedEvent(null)}
                            className="flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg font-semibold hover:bg-gray-200"
                          >
                            Cancel
                          </button>
                          <button
                            onClick={() => setSelectedEvent(null)}
                            className="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-indigo-700"
                          >
                            Save Results
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        };

        ReactDOM.render(<LMSSportsDay />, document.getElementById('root'));
    </script>
</body>
</html>
